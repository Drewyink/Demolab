<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Facets â€” Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="app-layout">
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="logo-icon">FX</div>
      <div>
        <div class="logo-text">FACETS</div>
        <div class="logo-sub">Config Suite</div>
      </div>
    </div>
    <nav class="sidebar-nav">
      <div class="nav-section-label">Overview</div>
      <a class="nav-item" href="index.html"><span class="nav-icon">â—ˆ</span> Dashboard</a>
      <div class="nav-section-label">Configuration</div>
      <a class="nav-item" href="members.html"><span class="nav-icon">ğŸ‘¤</span> Members</a>
      <a class="nav-item" href="products.html"><span class="nav-icon">ğŸ“¦</span> Products</a>
      <a class="nav-item" href="plans.html"><span class="nav-icon">ğŸ“‹</span> Plans</a>
      <a class="nav-item" href="benefits.html"><span class="nav-icon">âœš</span> Benefits</a>
      <a class="nav-item" href="pricing.html"><span class="nav-icon">ğŸ’²</span> Pricing</a>
      <div class="nav-section-label">Operations</div>
      <a class="nav-item" href="claims.html"><span class="nav-icon">ğŸ“„</span> Claims</a>
      <a class="nav-item" href="audit.html"><span class="nav-icon">ğŸ”</span> Audit Log</a>
    </nav>
    <div class="sidebar-footer">
      <div class="env-badge">Sandbox Â· v1.0</div>
    </div>
  </aside>
  <main class="main-content">
    <div class="topbar">
      <div class="topbar-left">
        <span class="topbar-breadcrumb"><span>Dashboard</span></span>
      </div>
      <div class="topbar-right">
        <span class="topbar-clock" id="clock"></span>
      </div>
    </div>
    <div class="page-content">
      <div class="page-header">
        <div>
          <div class="page-title">System Overview</div>
          <div class="page-subtitle">FACETS CONFIGURATION PLATFORM Â· SANDBOX</div>
        </div>
        <button class="btn btn-secondary" onclick="loadDashboard()">â†» Refresh</button>
      </div>
      <div class="stats-grid" id="stats-grid">
        <div class="stat-card blue"><div class="stat-icon">ğŸ‘¤</div><div class="stat-label">Members</div><div class="stat-value" id="stat-members">â€”</div><div class="stat-meta" id="stat-active-members">â€”</div></div>
        <div class="stat-card green"><div class="stat-icon">ğŸ“¦</div><div class="stat-label">Products</div><div class="stat-value" id="stat-products">â€”</div><div class="stat-meta">Active products</div></div>
        <div class="stat-card yellow"><div class="stat-icon">ğŸ“‹</div><div class="stat-label">Plans</div><div class="stat-value" id="stat-plans">â€”</div><div class="stat-meta">Configured plans</div></div>
        <div class="stat-card orange"><div class="stat-icon">âœš</div><div class="stat-label">Benefits</div><div class="stat-value" id="stat-benefits">â€”</div><div class="stat-meta">Benefit codes</div></div>
        <div class="stat-card red"><div class="stat-icon">ğŸ“„</div><div class="stat-label">Claims</div><div class="stat-value" id="stat-claims">â€”</div><div class="stat-meta" id="stat-pending">â€” pending</div></div>
        <div class="stat-card blue"><div class="stat-icon">ğŸ’²</div><div class="stat-label">Total Billed</div><div class="stat-value" id="stat-billed" style="font-size:20px">â€”</div><div class="stat-meta">All-time claims</div></div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
        <div class="card">
          <div class="card-header"><span class="card-title">âš¡ Quick Actions</span></div>
          <div class="card-body" style="display:flex;flex-direction:column;gap:10px">
            <a href="members.html" class="btn btn-secondary" style="justify-content:flex-start">ğŸ‘¤ &nbsp;Add New Member</a>
            <a href="products.html" class="btn btn-secondary" style="justify-content:flex-start">ğŸ“¦ &nbsp;Create Product</a>
            <a href="plans.html" class="btn btn-secondary" style="justify-content:flex-start">ğŸ“‹ &nbsp;Configure Plan</a>
            <a href="benefits.html" class="btn btn-secondary" style="justify-content:flex-start">âœš &nbsp;Set Up Benefit</a>
            <a href="pricing.html" class="btn btn-secondary" style="justify-content:flex-start">ğŸ’² &nbsp;Define Pricing Tier</a>
            <a href="claims.html" class="btn btn-secondary" style="justify-content:flex-start">ğŸ“„ &nbsp;Submit Claim</a>
          </div>
        </div>
        <div class="card">
          <div class="card-header"><span class="card-title">ğŸ” Recent Activity</span><a href="audit.html" class="btn btn-sm btn-secondary">View All</a></div>
          <div class="card-body" id="recent-activity" style="padding:0 20px">
            <div class="empty-state"><div class="empty-icon">ğŸ“‹</div><p>Loading activity...</p></div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script src="app.js"></script>
<script>
async function loadDashboard() {
  const stats = await apiFetch('/api/stats');
  document.getElementById('stat-members').textContent = stats.members;
  document.getElementById('stat-active-members').textContent = `${stats.active_members} active`;
  document.getElementById('stat-products').textContent = stats.products;
  document.getElementById('stat-plans').textContent = stats.plans;
  document.getElementById('stat-benefits').textContent = stats.benefits;
  document.getElementById('stat-claims').textContent = stats.claims;
  document.getElementById('stat-pending').textContent = `${stats.pending_claims} pending`;
  document.getElementById('stat-billed').textContent = currency(stats.total_claims_amount);
  const logs = await apiFetch('/api/audit');
  const actEl = document.getElementById('recent-activity');
  if (!logs.length) {
    actEl.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“‹</div><p>No activity yet</p></div>';
    return;
  }
  actEl.innerHTML = logs.slice(0, 8).map(l => `
    <div class="activity-item">
      <div class="activity-dot ${l.action.toLowerCase()}"></div>
      <div class="activity-text"><strong>${l.action}</strong> on <strong>${l.table_name}</strong></div>
      <div class="activity-time">${relTime(l.created_at)}</div>
    </div>`).join('');
}
loadDashboard();
</script>
</body>
</html>
