<!-- public/register.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>EcholinkSolutions | Facets Elements Sandbox - Register</title>
  <link rel="stylesheet" href="/styles.css"/>
</head>
<body>
  <div class="authShell">
    <div class="hero">
      <div class="brand" style="margin-bottom:10px">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Create Student Account</h1>
          <p>EcholinkSolutions Training Lab</p>
        </div>
      </div>
      <div class="hr"></div>
      <div class="small">Account is stored locally in this training SQLite database.</div>
      <div class="footerNote">For a classroom deployment, host per cohort or add tenant IDs.</div>
    </div>

    <div class="card">
      <h2>Register</h2>
      <div class="form">
        <div class="full">
          <label class="small">Full Name</label>
          <input id="name" placeholder="Your name" autocomplete="name"/>
        </div>
        <div class="full">
          <label class="small">Email</label>
          <input id="email" placeholder="you@example.com" autocomplete="username"/>
        </div>
        <div class="full">
          <label class="small">Password</label>
          <input id="password" type="password" placeholder="At least 6 characters" autocomplete="new-password"/>
        </div>
        <div class="full row">
          <button class="btn" id="btnRegister">Create account</button>
          <button class="btn ghost" id="btnBack">Back to login</button>
        </div>
      </div>
    </div>

    <div class="toast" id="toast"></div>
  </div>

<script>
const $=(s)=>document.querySelector(s);
async function api(path, opts={}){
  const res = await fetch(path, { headers:{ "Content-Type":"application/json" }, ...opts });
  const ct=res.headers.get("content-type")||"";
  const data = ct.includes("application/json") ? await res.json() : await res.text();
  if(!res.ok) throw new Error(data?.error || data || `HTTP ${res.status}`);
  return data;
}
function toast(msg){ const t=$("#toast"); t.textContent=msg; t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),2600); }

$("#btnBack").addEventListener("click",()=>location.href="/login.html");

$("#btnRegister").addEventListener("click", async ()=>{
  try{
    const full_name=$("#name").value.trim();
    const email=$("#email").value.trim();
    const password=$("#password").value;
    await api("/api/auth/register",{ method:"POST", body: JSON.stringify({ full_name, email, password })});
    toast("Account created. Now login.");
    setTimeout(()=>location.href="/login.html", 900);
  }catch(e){ toast(e.message); }
});
</script>
</body>
</html>

